<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title> Calculadora Inteligente</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(to right, #e0f7fa, #e1bee7);
            display: flex;
            justify-content: center;
            align-items: start;
            padding-top: 3rem;
            min-height: 100vh;
        }

        .card {
            background: #fff;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            width: 400px;
        }

        h2 {
            text-align: center;
            color: #4a148c;
        }

        select, input, button {
            width: 100%;
            padding: 0.6rem;
            margin-top: 1rem;
            border: 1px solid #ccc;
            border-radius: 0.5rem;
            font-size: 1rem;
        }

        button {
            background-color: #7e57c2;
            color: white;
            border: none;
            cursor: pointer;
            transition: background 0.3s;
        }

        button:hover {
            background-color: #5e35b1;
        }

        #inputHelp {
            font-size: 0.9rem;
            color: #555;
            margin-top: 0.5rem;
        }

        #result {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #f3e5f5;
            border-left: 5px solid #ab47bc;
            display: none;
            border-radius: 0.5rem;
            white-space: pre-line;
        }

        label {
            margin-top: 1rem;
            display: block;
            font-weight: bold;
        }
    </style>
</head>
<body>
<div class="card">
    <h2> Calculadora Inteligente</h2>
    <label for="mainMenu">Selecciona una categor铆a:</label>
    <select id="mainMenu">
        <option value="0">Operaciones b谩sicas</option>
        <option value="1">Sucesiones</option>
        <option value="2">Orden</option>
        <option value="3">Probabilidad</option>
    </select>

    <div id="inputContainer"></div>
    <div id="inputHelp"></div>
    <div id="result"></div>
</div>

<script>
    const mainMenu = document.getElementById('mainMenu');
    const inputContainer = document.getElementById('inputContainer');
    const inputHelp = document.getElementById('inputHelp');
    const result = document.getElementById('result');

    mainMenu.addEventListener('change', actualizarInterfaz);

    document.addEventListener('click', function (event) {
        if (event.target && event.target.id === 'submitBtn') {
            const selectedOption = mainMenu.value;
            switch (selectedOption) {
                case "0": handleBasicOperations(); break;
                case "1": handleSequences(); break;
                case "2": handleOrder(); break;
                case "3": handleProbability(); break;
            }
        }
    });

    function actualizarInterfaz() {
        const selectedOption = mainMenu.value;
        result.style.display = "none";
        inputContainer.innerHTML = '';
        inputHelp.innerText = '';

        switch (selectedOption) {
            case "0":
                inputContainer.innerHTML = `
                    <select id="basicOperations">
                        <option value="0">Divisi贸n</option>
                        <option value="1">MCM</option>
                        <option value="2">MCD</option>
                        <option value="3">N煤mero primo</option>
                    </select>
                    <div id="dynamicInputs"></div>
                    <button id="submitBtn">Aceptar</button>
                `;
                document.getElementById('basicOperations').addEventListener('change', mostrarInputsBasicos);
                mostrarInputsBasicos();
                break;
            case "1":
                inputContainer.innerHTML = `
                    <select id="sequences">
                        <option value="0">Fibonacci</option>
                        <option value="1">Congruencia</option>
                        <option value="2">Teorema de Euler</option>
                        <option value="3">Sucesi贸n aritm茅tica</option>
                        <option value="4">Sucesi贸n geom茅trica</option>
                    </select>
                    <div id="dynamicInputs"></div>
                    <button id="submitBtn">Aceptar</button>
                `;
                document.getElementById('sequences').addEventListener('change', mostrarInputsSucesiones);
                mostrarInputsSucesiones();
                break;
            case "2":
                inputContainer.innerHTML = `
                    <select id="order">
                        <option value="0">Ascendente</option>
                        <option value="1">Descendente</option>
                    </select>
                    <input type="number" id="input1" placeholder="L铆mite m谩ximo">
                    <button id="submitBtn">Aceptar</button>
                `;
                inputHelp.innerText = "Esta operaci贸n necesita un n煤mero.";
                break;
            case "3":
                inputContainer.innerHTML = `
                    <select id="probability">
                        <option value="0">Permutaci贸n</option>
                        <option value="1">Combinaci贸n</option>
                    </select>
                    <input type="number" id="input1" placeholder="Ingrese n">
                    <input type="number" id="input2" placeholder="Ingrese r">
                    <button id="submitBtn">Aceptar</button>
                `;
                inputHelp.innerText = "Esta operaci贸n necesita dos n煤meros.";
                break;
        }
    }

    function mostrarInputsBasicos() {
        const tipo = document.getElementById('basicOperations').value;
        const dynamicInputs = document.getElementById('dynamicInputs');

        if (tipo === "3") {
            dynamicInputs.innerHTML = `<input type="number" id="input1" placeholder="N煤mero a verificar">`;
            inputHelp.innerText = "Solo se necesita un n煤mero.";
        } else {
            dynamicInputs.innerHTML = `
                <input type="number" id="input1" placeholder="N煤mero 1">
                <input type="number" id="input2" placeholder="N煤mero 2">
            `;
            inputHelp.innerText = "Esta operaci贸n necesita dos n煤meros.";
        }
    }

    function mostrarInputsSucesiones() {
        const tipo = document.getElementById('sequences').value;
        const dynamicInputs = document.getElementById('dynamicInputs');

        switch (tipo) {
            case "0":
                dynamicInputs.innerHTML = `<input type="number" id="input1" placeholder="Cantidad de t茅rminos">`;
                inputHelp.innerText = "Introduce la cantidad de t茅rminos de Fibonacci.";
                break;
            case "3":
                dynamicInputs.innerHTML = `
                    <input type="number" id="input1" placeholder="Primer t茅rmino">
                    <input type="number" id="input2" placeholder="Posici贸n del segundo t茅rmino">
                    <input type="number" id="input3" placeholder="Segundo t茅rmino">
                `;
                inputHelp.innerText = "A = primer t茅rmino, posici贸n del segundo t茅rmino, y su valor.";
                break;
            default:
                dynamicInputs.innerHTML = `
                    <input type="number" id="input1" placeholder="Valor A / Base">
                    <input type="number" id="input2" placeholder="Valor B / Exponente">
                    <input type="number" id="input3" placeholder="M贸dulo N / Posici贸n">
                `;
                inputHelp.innerText = "Se necesitan tres valores para esta operaci贸n.";
                break;
        }
    }

    function handleBasicOperations() {
        const op = document.getElementById('basicOperations').value;
        const n1 = parseInt(document.getElementById('input1').value);
        const n2 = document.getElementById('input2') ? parseInt(document.getElementById('input2').value) : null;

        if (isNaN(n1) || (op <= 2 && isNaN(n2))) {
            result.innerText = "Por favor ingrese los valores necesarios.";
            result.style.display = "block";
            return;
        }

        switch (op) {
            case "0": result.innerText = `Divisi贸n: ${n1} 梅 ${n2} = ${n1 / n2}`; break;
            case "1": result.innerText = `MCM: ${mcm(n1, n2)}`; break;
            case "2": result.innerText = `MCD: ${mcd(n1, n2)}`; break;
            case "3": result.innerText = isPrime(n1) ? `${n1} es primo.` : `${n1} no es primo.`; break;
        }

        result.style.display = "block";
    }

    function handleSequences() {
        const op = document.getElementById('sequences').value;
        const a = parseInt(document.getElementById('input1').value);
        const b = parseInt(document.getElementById('input2')?.value);
        const n = parseInt(document.getElementById('input3')?.value);

        let output = "";

        switch (op) {
            case "0":
                if (isNaN(a)) return mostrarError();
                let fib = [0, 1];
                for (let i = 2; i < a; i++) fib.push(fib[i - 1] + fib[i - 2]);
                output = `Fibonacci (${a} t茅rminos): ${fib.slice(0, a).join(', ')}`;
                break;
            case "1":
                if ([a, b, n].some(isNaN)) return mostrarError();
                const diff = a - b;
                const esCongruente = diff % n === 0;
                const residuo = a % n;
                output = `${a} ${esCongruente ? "es" : "no es"} congruente con ${b} modulo ${n}.
${a} - ${b} = ${diff}, y ${n} ${esCongruente ? "divide" : "no divide"} a ${diff}, el residuo es igual a: ${residuo}.`;
                break;
            case "2":
                if ([a, b, n].some(isNaN)) return mostrarError();
                output = `${a}^${b} mod ${n} = ${modExp(a, b, n)}`;
                break;
                case "3":
                    if ([a, b, n].some(isNaN) || b <= 1) return mostrarError();
                    const diferencia = (n - a) / (b - 1);
                    const sucesion = Array.from({ length: b }, (_, i) => (a + i * diferencia).toFixed(2));
                    output = `Sucesi贸n aritm茅tica: ${sucesion.join(', ')}\nRaz贸n: ${diferencia.toFixed(2)}`;
                    break;
                    case "4":
                        if ([a, b, n].some(isNaN) || b <= 1 || a === 0) return mostrarError();
                        const razon = Math.pow(n / a, 1 / (b - 1));
                        const geoSucesion = Array.from({ length: b }, (_, i) => (a * Math.pow(razon, i)).toFixed(2));
                        output = `Sucesi贸n geom茅trica: ${geoSucesion.join(', ')}\nRaz贸n: ${razon.toFixed(2)}`;
                        break;

        }

        result.innerText = output;
        result.style.display = "block";
    }

    function mostrarError() {
        result.innerText = "Por favor completa todos los campos correctamente.";
        result.style.display = "block";
    }

    function handleOrder() {
        const n = parseInt(document.getElementById('input1').value);
        const op = document.getElementById('order').value;

        if (isNaN(n)) return mostrarError();

        let nums = Array.from({ length: n }, (_, i) => i + 1);
        result.innerText = (op === "0" ? nums : nums.reverse()).join(", ");
        result.style.display = "block";
    }

    function handleProbability() {
        const n = parseInt(document.getElementById('input1').value);
        const r = parseInt(document.getElementById('input2').value);
        const op = document.getElementById('probability').value;

        if (isNaN(n) || isNaN(r)) return mostrarError();
        if (n < r) {
            result.innerText = "n debe ser mayor o igual a r.";
        } else {
            const factorial = x => x <= 1 ? 1 : x * factorial(x - 1);
            if (op === "0") {
                result.innerText = `Permutaci贸n: P(${n},${r}) = ${factorial(n) / factorial(n - r)}`;
            } else {
                result.innerText = `Combinaci贸n: C(${n},${r}) = ${factorial(n) / (factorial(r) * factorial(n - r))}`;
            }
        }

        result.style.display = "block";
    }

    const mcd = (a, b) => b === 0 ? a : mcd(b, a % b);
    const mcm = (a, b) => (a * b) / mcd(a, b);
    const isPrime = n => n > 1 && Array.from({ length: Math.floor(Math.sqrt(n)) }, (_, i) => i + 2).every(i => n % i !== 0);
    const modExp = (a, b, n) => {
        let res = 1;
        a = a % n;
        while (b > 0) {
            if (b % 2 === 1) res = (res * a) % n;
            a = (a * a) % n;
            b = Math.floor(b / 2);
        }
        return res;
    };

    actualizarInterfaz();
</script>
</body>
</html>
