<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>üß† Calculadora Inteligente</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #e0f7fa, #e1bee7);
      display: flex;
      justify-content: center;
      align-items: start;
      padding-top: 3rem;
      min-height: 100vh;
    }

    .card {
      background: #fff;
      border-radius: 1rem;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      padding: 2rem;
      width: 400px;
    }

    h2 {
      text-align: center;
      color: #4a148c;
    }

    select, input, button {
      width: 100%;
      padding: 0.6rem;
      margin-top: 1rem;
      border: 1px solid #ccc;
      border-radius: 0.5rem;
      font-size: 1rem;
    }

    button {
      background-color: #7e57c2;
      color: white;
      border: none;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover {
      background-color: #5e35b1;
    }

    #inputHelp {
      font-size: 0.9rem;
      color: #555;
      margin-top: 0.5rem;
    }

    #result {
      margin-top: 1rem;
      padding: 1rem;
      background-color: #f3e5f5;
      border-left: 5px solid #ab47bc;
      display: none;
      border-radius: 0.5rem;
    }

    label {
      margin-top: 1rem;
      display: block;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="card">
    <h2>üß† Calculadora Inteligente</h2>
    <label for="mainMenu">Selecciona una categor√≠a:</label>
    <select id="mainMenu">
      <option value="0">Operaciones b√°sicas</option>
      <option value="1">Sucesiones</option>
      <option value="2">Orden</option>
      <option value="3">Probabilidad</option>
    </select>

    <div id="inputContainer"></div>
    <div id="inputHelp"></div>
    <div id="result"></div>
  </div>

  <script>
    const mainMenu = document.getElementById('mainMenu');
    const inputContainer = document.getElementById('inputContainer');
    const inputHelp = document.getElementById('inputHelp');
    const result = document.getElementById('result');

    mainMenu.addEventListener('change', actualizarInterfaz);

    document.addEventListener('click', function (event) {
      if (event.target && event.target.id === 'submitBtn') {
        const selectedOption = mainMenu.value;

        switch (selectedOption) {
          case "0": handleBasicOperations(); break;
          case "1": handleSequences(); break;
          case "2": handleOrder(); break;
          case "3": handleProbability(); break;
        }
      }
    });

    function actualizarInterfaz() {
      const selectedOption = mainMenu.value;
      result.style.display = "none";
      inputContainer.innerHTML = '';
      inputHelp.innerText = '';

      switch (selectedOption) {
        case "0":
          inputContainer.innerHTML = `
            <select id="basicOperations">
              <option value="0">Divisi√≥n</option>
              <option value="1">MCM</option>
              <option value="2">MCD</option>
              <option value="3">N√∫mero primo</option>
            </select>
            <div id="dynamicBasicInputs"></div>
            <button id="submitBtn">Aceptar</button>
          `;
          document.getElementById('basicOperations').addEventListener('change', mostrarInputsBasicos);
          mostrarInputsBasicos(); // Inicial
          break;

        case "1":
          inputContainer.innerHTML = `
            <select id="sequences">
              <option value="0">Fibonacci</option>
              <option value="1">Congruencia</option>
              <option value="2">Teorema de Euler</option>
              <option value="3">Sucesi√≥n aritm√©tica</option>
              <option value="4">Sucesi√≥n geom√©trica</option>
            </select>
            <div id="dynamicInputs"></div>
            <button id="submitBtn">Aceptar</button>
          `;
          document.getElementById('sequences').addEventListener('change', mostrarInputsSucesiones);
          mostrarInputsSucesiones(); // Inicial
          break;

        case "2":
          inputContainer.innerHTML = `
            <select id="order">
              <option value="0">Ascendente</option>
              <option value="1">Descendente</option>
            </select>
            <input type="number" id="input1" placeholder="L√≠mite m√°ximo">
            <button id="submitBtn">Aceptar</button>
          `;
          inputHelp.innerText = "Esta operaci√≥n necesita un n√∫mero.";
          break;

        case "3":
          inputContainer.innerHTML = `
            <select id="probability">
              <option value="0">Permutaci√≥n</option>
              <option value="1">Combinaci√≥n</option>
            </select>
            <input type="number" id="input1" placeholder="Ingrese n">
            <input type="number" id="input2" placeholder="Ingrese r">
            <button id="submitBtn">Aceptar</button>
          `;
          inputHelp.innerText = "Esta operaci√≥n necesita dos n√∫meros.";
          break;
      }
    }

    function mostrarInputsBasicos() {
      const op = document.getElementById('basicOperations').value;
      const container = document.getElementById('dynamicBasicInputs');

      if (op === "3") {
        container.innerHTML = `
          <input type="number" id="input1" placeholder="N√∫mero a verificar">
        `;
        inputHelp.innerText = "Esta operaci√≥n necesita un n√∫mero.";
      } else {
        container.innerHTML = `
          <input type="number" id="input1" placeholder="N√∫mero 1">
          <input type="number" id="input2" placeholder="N√∫mero 2">
        `;
        inputHelp.innerText = "Esta operaci√≥n necesita dos n√∫meros.";
      }
    }

    function mostrarInputsSucesiones() {
      const tipo = document.getElementById('sequences').value;
      const dynamicInputs = document.getElementById('dynamicInputs');
      inputHelp.innerText = '';

      if (tipo === "0") {
        dynamicInputs.innerHTML = `<input type="number" id="input1" placeholder="Cantidad de t√©rminos">`;
        inputHelp.innerText = "Introduce la cantidad de t√©rminos de Fibonacci.";
      } else {
        dynamicInputs.innerHTML = `
          <input type="number" id="input1" placeholder="Valor A / Primer t√©rmino">
          <input type="number" id="input2" placeholder="Segundo t√©rmino / k / B">
          <input type="number" id="input3" placeholder="M√≥dulo N / Posici√≥n">
        `;
        inputHelp.innerText = "Esta operaci√≥n necesita tres entradas.";
      }
    }

    // L√≥gica
    function handleBasicOperations() {
      const op = document.getElementById('basicOperations').value;
      const n1 = parseInt(document.getElementById('input1').value);
      const n2Input = document.getElementById('input2');
      const n2 = n2Input ? parseInt(n2Input.value) : null;

      if (isNaN(n1) || (op <= 2 && isNaN(n2))) {
        result.innerText = "Por favor ingrese los valores necesarios.";
        result.style.display = "block";
        return;
      }

      switch (op) {
        case "0": result.innerText = `Divisi√≥n: ${n1} √∑ ${n2} = ${n1 / n2}`; break;
        case "1": result.innerText = `MCM: ${mcm(n1, n2)}`; break;
        case "2": result.innerText = `MCD: ${mcd(n1, n2)}`; break;
        case "3": result.innerText = isPrime(n1) ? `${n1} es primo.` : `${n1} no es primo.`; break;
      }

      result.style.display = "block";
    }

    function handleSequences() {
      const op = document.getElementById('sequences').value;
      const a = parseInt(document.getElementById('input1').value);
      const b = document.getElementById('input2') ? parseInt(document.getElementById('input2').value) : null;
      const n = document.getElementById('input3') ? parseInt(document.getElementById('input3').value) : null;

      if (op !== "0" && ([a, b, n].some(x => isNaN(x)))) {
        result.innerText = "Por favor completa todos los campos.";
        result.style.display = "block";
        return;
      }

      let output = "";
      switch (op) {
        case "0":
          let fib = [0, 1];
          for (let i = 2; i < a; i++) fib.push(fib[i - 1] + fib[i - 2]);
          output = `Fibonacci (${a}): ${fib.slice(0, a).join(', ')}`;
          break;
        case "1": output = `${a} ‚â° ${a % n} (mod ${n})`; break;
        case "2": output = `${a}^${b} mod ${n} = ${modExp(a, b, n)}`; break;
        case "3":
          const d = (b - a) / (n - 1);
          const arit = Array.from({ length: n }, (_, i) => a + i * d);
          output = `Sucesi√≥n aritm√©tica: ${arit.join(', ')}`;
          break;
        case "4":
          const r = Math.pow(b / a, 1 / (n - 1));
          const geo = Array.from({ length: n }, (_, i) => (a * Math.pow(r, i)).toFixed(2));
          output = `Sucesi√≥n geom√©trica: ${geo.join(', ')}`;
          break;
      }

      result.innerText = output;
      result.style.display = "block";
    }

    function handleOrder() {
      const n = parseInt(document.getElementById('input1').value);
      const op = document.getElementById('order').value;

      if (isNaN(n)) {
        result.innerText = "Por favor ingrese un n√∫mero.";
        result.style.display = "block";
        return;
      }

      let nums = Array.from({ length: n }, (_, i) => i + 1);
      result.innerText = (op === "0" ? nums : nums.reverse()).join(", ");
      result.style.display = "block";
    }

    function handleProbability() {
      const n = parseInt(document.getElementById('input1').value);
      const r = parseInt(document.getElementById('input2').value);
      const op = document.getElementById('probability').value;

      if (isNaN(n) || isNaN(r)) {
        result.innerText = "Por favor ingrese n y r.";
        result.style.display = "block";
        return;
      }

      if (n < r) {
        result.innerText = "n debe ser mayor o igual a r.";
      } else {
        const factorial = x => x <= 1 ? 1 : x * factorial(x - 1);
        if (op === "0") {
          result.innerText = `Permutaci√≥n: P(${n},${r}) = ${factorial(n) / factorial(n - r)}`;
        } else {
          result.innerText = `Combinaci√≥n: C(${n},${r}) = ${factorial(n) / (factorial(r) * factorial(n - r))}`;
        }
      }

      result.style.display = "block";
    }

    // Funciones auxiliares
    const mcd = (a, b) => b === 0 ? a : mcd(b, a % b);
    const mcm = (a, b) => (a * b) / mcd(a, b);
    const isPrime = n => {
      if (n <= 1) return false;
      for (let i = 2; i <= Math.sqrt(n); i++) {
        if (n % i === 0) return false;
      }
      return true;
    };
    const modExp = (a, b, n) => {
      let res = 1;
      a = a % n;
      while (b > 0) {
        if (b % 2 === 1) res = (res * a) % n;
        a = (a * a) % n;
        b = Math.floor(b / 2);
      }
      return res;
    };

    actualizarInterfaz();
  </script>
</body>
</html>
